<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- https://raw.githubusercontent.com/Laaouatni/laaWebComponentLibrary/refs/heads/main/laaWebComponentLibrary.js -->
  <!--DEV-->
  <script src="https://cdn.jsdelivr.net/gh/Laaouatni/laaWebComponentLibrary/laaWebComponentLibrary.js"></script>
  <!--PROD-->
  <!-- <script src="https://cdn.jsdelivr.net/gh/Laaouatni/laaWebComponentLibrary/laaWebComponentLibrary.min.js"></script> -->
  <script>
    const ipEsp32 = '192.168.113.49';
    const ws = new WebSocket(`ws://${ipEsp32}/ws`);
    const globalState = new laaState({});

    ws.addEventListener("close", () => {
      window.location.reload();
    });

    ws.addEventListener("message", (message) => {
      globalState.state.led = message;
    });
  </script>
</head>

<body class="p-2 bg-gray-200">
  <laa-led></laa-led>

  <template id="laa-led" class="grid {thisComponent.state.isLedOn == 1 ? 'bg-green-500' : 'bg-red-500'}">
    il led Ã¨ <span data-var="{thisComponent.state.isLedOn ? 'accesso' : 'spento'}"></span>
    <input type="range" min="0" max="1" step="1" value="{thisComponent.state.isLedOn}" oninput="globalState.state.led = this.value">
    <script>
      const thisComponent = document.currentScript.parentElement;
      globalState.listenToVariableChange("led", (value) => thisComponent.state.isLedOn = value);
    </script>
  </template>
</body>

</html>